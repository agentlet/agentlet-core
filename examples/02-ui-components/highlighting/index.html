<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Highlighting - Agentlet Core UI Components</title>
    <link rel="stylesheet" href="../../shared/examples.css">
    <link rel="stylesheet" href="../../shared/two-column-layout.css">
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- Override PageHighlighter message text color for better visibility on blue backgrounds -->
    <style>
        .agentlet-message-text {
            color: #FFF !important;
        }
        
        /* Ensure centered banners also get blue background */
        .agentlet-overlay[data-position="center"] {
            background-color: #007bff !important;
        }
        
        .agentlet-overlay[data-type="info"] {
            background-color: #007bff !important;
        }
        
        /* Additional fallback for centered info overlays */
        .agentlet-overlay.agentlet-overlay-center.agentlet-overlay-info {
            background-color: #007bff !important;
        }
        
        /* Ensure message content background is also blue for info type */
        .agentlet-message-content[data-type="info"] {
            background-color: #007bff !important;
        }
        
        .agentlet-message-content.agentlet-message-info {
            background-color: #007bff !important;
        }
        
        /* Target all info message content containers */
        .agentlet-overlay-info .agentlet-message-content {
            background-color: #007bff !important;
        }
        
        /* Override the specific rule for center info messages */
        .agentlet-message-overlay.center .agentlet-message-content.info {
            background: #007bff !important;
            color: #FFF !important;
            border-left: 4px solid #0056b3 !important;
        }
        
        /* Fix progress bar hierarchy - start from the top level */
        .agentlet-progress-bar {
            width: 100% !important;
            display: block !important;
            margin: 5px 0 !important;
        }
        
        .agentlet-progress-container {
            width: 100% !important;
            margin: 10px 0 !important;
            display: block !important;
        }
        
        /* Ensure progress bar track/container has proper styling */
        .agentlet-progress {
            height: 6px !important;
            background-color: rgba(255, 255, 255, 0.3) !important;
            border-radius: 3px !important;
            overflow: hidden !important;
            width: 100% !important;
            position: relative !important;
            display: block !important;
            margin: 5px 0 !important;
        }
        
        /* Fix progress bar fill display */
        .agentlet-progress-fill {
            height: 6px !important;
            min-height: 6px !important;
            background-color: #28a745 !important;
            transition: width 0.3s ease !important;
            display: block !important;
            border-radius: 3px !important;
            /* Don't override width - let inline styles control it */
        }
        
        /* Also target any potential wrapper elements */
        .agentlet-message-content .agentlet-progress {
            width: 100% !important;
            display: block !important;
        }
        
        .agentlet-overlay .agentlet-progress {
            width: 100% !important;
            display: block !important;
        }
        
        /* Set blue background for progress overlays */
        .agentlet-overlay[data-type="progress"] {
            background-color: #007bff !important;
        }
        
        .agentlet-message-content[data-type="progress"] {
            background-color: #007bff !important;
        }
        
        .agentlet-overlay.agentlet-overlay-progress .agentlet-message-content {
            background-color: #007bff !important;
        }
        
        /* Override the general center overlay styling */
        .agentlet-message-overlay.center .agentlet-message-content {
            background: #007bff !important;
            color: #FFF !important;
        }
        
        
        /* Make sure tooltips/messages are clearly visible */
        .agentlet-message-content {
            z-index: 10002 !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="two-column-container">
            <!-- Left Column: Content and Controls -->
            <div class="left-column">
                <div class="nav-breadcrumb">
                    <a href="../../">Examples</a> ‚Üí <a href="../">02-ui-components</a> ‚Üí highlighting
                </div>

                <h1>üéØ Page Highlighting - Agentlet Core UI Components</h1>
                
                <p>The PageHighlighter utility enables dynamic highlighting of page elements and displaying overlays with messages or progress indicators. Perfect for drawing attention to elements and providing contextual feedback.</p>

                <div class="example-section">
                    <h3>What this example shows:</h3>
                    <ul>
                        <li>Full-screen overlays with customizable messages and progress bars</li>
                        <li>Element highlighting with multiple visual styles (border, arrows, stickers)</li>
                        <li>Dynamic control of highlights (show, hide, update, destroy)</li>
                        <li>Animation and positioning options</li>
                        <li>Clickable highlights with interaction handling</li>
                    </ul>
                </div>

                <div class="controls">
                    <h4>üöÄ Initialize</h4>
                    <button onclick="initAgentlet()" id="initBtn">Initialize Agentlet Core</button>
                    <button onclick="checkStatus()">Check Status</button>
                </div>
                
                <div class="controls">
                    <h4>üì± Overlay Examples</h4>
                    <button onclick="showTopBanner()" id="topBannerBtn">Top Banner</button>
                    <button onclick="showBottomBanner()" id="bottomBannerBtn">Bottom Banner</button>
                    <button onclick="showCenterOverlay()" id="centerBtn">Centered Banner</button>
                    <button onclick="showWithBackground()" id="backgroundBtn">With Background Overlay</button>
                    <button onclick="showCloseableMessage()" id="closeableBtn">Closeable Message</button>
                </div>

                <div class="controls">
                    <h4>üìä Progress Examples</h4>
                    <button onclick="showProgressOverlay()" id="progressBtn">Center Progress</button>
                    <button onclick="showTopProgress()" id="topProgressBtn">Top Progress Banner</button>
                    <button onclick="showBottomProgress()" id="bottomProgressBtn">Bottom Progress Banner</button>
                    <button onclick="clearAllOverlays()" id="clearOverlaysBtn">Clear All Overlays</button>
                </div>

                <div class="controls">
                    <h4>üéØ Element Highlighting Examples</h4>
                    <button onclick="highlightWithBorder()" id="borderBtn">Border Highlight</button>
                    <button onclick="highlightWithArrow()" id="arrowBtn">Arrow Pointer</button>
                    <button onclick="highlightWithSticker()" id="stickerBtn">Sticker Badge</button>
                    <button onclick="clearAllHighlights()" id="clearHighlightsBtn">Clear All Highlights</button>
                </div>

                <div class="controls">
                    <h4>üóÇÔ∏è Advanced Features</h4>
                    <button onclick="showClickableHighlight()" id="clickableBtn">Clickable Highlight</button>
                    <button onclick="updateHighlightDemo()" id="updateBtn">Update Highlight</button>
                </div>

                <div class="controls">
                    <h4>üìç Scroll Controls</h4>
                    <button onclick="scrollToTop()" id="scrollTopBtn">Scroll to Top</button>
                    <button onclick="scrollToBottom()" id="scrollBottomBtn">Scroll to Bottom</button>
                    <button onclick="scrollToTable()" id="scrollTableBtn">Scroll to Table</button>
                    <button onclick="scrollToAndHighlightDemo()" id="scrollHighlightBtn">Scroll + Highlight Demo</button>
                    <button onclick="scrollWithOffset()" id="scrollOffsetBtn">Scroll with Offset</button>
                    <button onclick="clearAll()" id="clearAllBtn">Clear Everything</button>
                </div>

                <!-- Demo elements for highlighting -->
                <div class="example-section">
                    <h3 id="demo-title">üéØ Demo Elements (for highlighting)</h3>
                    <p id="demo-paragraph">This paragraph can be highlighted with different styles and effects.</p>
                    
                    <div style="display: flex; gap: 20px; margin: 20px 0;">
                        <button id="demo-button" style="background: #28a745; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer;">Demo Button</button>
                        <input id="demo-input" type="text" placeholder="Demo Input Field" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
                        <select id="demo-select" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option>Option 1</option>
                            <option>Option 2</option>
                        </select>
                    </div>

                    <table id="demo-table" style="margin-top: 20px; width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #ddd;">Column 1</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Column 2</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Column 3</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 1, Cell 1</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 1, Cell 2</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 1, Cell 3</td>
                            </tr>
                            <tr id="demo-table-row">
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 2, Cell 1</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 2, Cell 2</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">Row 2, Cell 3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="example-section">
                    <h3>üìú PageHighlighter API Reference:</h3>
                    <div class="code-block">
                        <h4>1. Show Overlays</h4>
                        <pre><code class="language-javascript">// Top banner (full width, sticks to top)
const topBanner = window.agentlet.utils.PageHighlighter.showOverlay({
    message: 'Important announcement!',
    position: 'top',    // 'top', 'bottom', 'center'
    type: 'info',       // 'info', 'success', 'warning', 'error', 'progress'
    duration: 5000      // Auto-hide after 5 seconds
});

// Bottom banner (full width, sticks to bottom)
const bottomBanner = window.agentlet.utils.PageHighlighter.showOverlay({
    message: 'Status update',
    position: 'bottom',
    type: 'success',
    closeable: true     // Shows close button
});</code></pre>
                        
                        <h4>2. Highlight Elements</h4>
                        <pre><code class="language-javascript">// Border highlight
const highlight = window.agentlet.utils.PageHighlighter.highlight('#my-element', {
    type: 'border',        // 'border', 'arrow', 'sticker', 'pulse'
    style: 'primary',      // 'primary', 'success', 'warning', 'danger'
    message: 'Click here!',
    animation: 'pulse'     // 'pulse', 'glow', 'bounce', 'none'
});

// Arrow pointer
const arrow = window.agentlet.utils.PageHighlighter.highlight('#important-element', {
    type: 'arrow',
    position: 'top',       // Arrow position
    message: 'Look at this!'
});</code></pre>

                    </div>
                </div>
            </div>

            <!-- Right Column: Console and Status -->
            <div class="right-column">
                <div class="console-header">
                    <h3>üìü Console Output</h3>
                    <button onclick="clearConsole()" class="console-clear-btn">üóëÔ∏è Clear</button>
                </div>
                <div class="console-section" id="console"></div>
                
                <h3>üìä Status</h3>
                <div class="status-section" id="status">
                    Click "Initialize Agentlet Core" to start the demo.
                </div>
                
                
                <h3>üéØ Highlighting Activity</h3>
                <div class="stats-section" id="highlightStats">
                    <div>PageHighlighter available: <span id="highlighterAvailable">No</span></div>
                    <div>Active highlights: <span id="activeHighlights">0</span></div>
                    <div>Active overlays: <span id="activeOverlays">0</span></div>
                    <div>Last highlight type: <span id="lastHighlightType">None</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Console utilities -->
    <script src="../../shared/console-utils.js"></script>

    <script>
        let agentletInstance = null;
        let currentHighlights = [];
        let currentOverlays = [];
        let progressOverlay = null;
        let lastHighlightType = 'None';
        
        // Configure Agentlet before loading
        window.agentletConfig = {
            debugMode: true,
            theme: 'default',
            startMinimized: true  // Start with panel minimized
        };

        // Update highlighting stats display
        function updateHighlightingStats() {
            const elements = {
                highlighterAvailable: document.getElementById('highlighterAvailable'),
                activeHighlights: document.getElementById('activeHighlights'),
                activeOverlays: document.getElementById('activeOverlays'),
                lastHighlightType: document.getElementById('lastHighlightType')
            };

            if (elements.highlighterAvailable) {
                const available = !!(window.agentlet && window.agentlet.utils && window.agentlet.utils.PageHighlighter);
                elements.highlighterAvailable.textContent = available ? 'Yes' : 'No';
            }
            
            if (elements.activeHighlights) {
                elements.activeHighlights.textContent = currentHighlights.length;
            }
            
            if (elements.activeOverlays) {
                elements.activeOverlays.textContent = currentOverlays.length;
            }
            
            if (elements.lastHighlightType) {
                elements.lastHighlightType.textContent = lastHighlightType;
            }
        }

        async function initAgentlet() {
            try {
                setButtonLoading('initBtn', true);
                updateStatus('Loading Agentlet Core...', 'info');
                log('ü§ñ Starting Agentlet Core initialization...');

                // Check if already loaded
                if (window.agentlet) {
                    log('‚ö†Ô∏è Agentlet Core already loaded', 'warning');
                    updateStatus('Agentlet Core already initialized!', 'success');
                    setButtonLoading('initBtn', false);
                    updateHighlightingStats();
                    return;
                }

                // Simulate loading delay for demonstration
                await new Promise(resolve => setTimeout(resolve, 500));

                // Dynamically load Agentlet Core
                const script = document.createElement('script');
                script.src = '../../../dist/agentlet-core.js?' + Date.now();
                
                script.onload = () => {
                    log('‚úÖ Agentlet Core script loaded successfully', 'success');
                    
                    let AgentletConstructor = null;
                    if (window.AgentletCore) {
                        AgentletConstructor = window.AgentletCore.default;
                    }
                    
                    if (AgentletConstructor) {
                        try {
                            log('üöÄ Creating AgentletCore instance...');
                            agentletInstance = new AgentletConstructor(window.agentletConfig);
                            
                            log('‚öôÔ∏è Starting initialization...');
                            agentletInstance.init().then(() => {
                                log('‚úÖ Agentlet Core initialized successfully', 'success');
                                log('üéØ PageHighlighter utility available at window.agentlet.utils.PageHighlighter');
                                
                                // Debug what's actually available
                                log(`üîç window.agentlet exists: ${!!window.agentlet}`);
                                log(`üîç window.agentlet.utils exists: ${!!(window.agentlet && window.agentlet.utils)}`);
                                if (window.agentlet && window.agentlet.utils) {
                                    log(`üîç Available utils: ${Object.keys(window.agentlet.utils).join(', ')}`);
                                }
                                
                                // Test PageHighlighter availability with more detail
                                if (window.agentlet && window.agentlet.utils && window.agentlet.utils.PageHighlighter) {
                                    log('‚úÖ PageHighlighter utility is available', 'success');
                                    updateStatus('Agentlet Core loaded! PageHighlighter ready to use.', 'success');
                                } else {
                                    log('‚ùå PageHighlighter utility not found', 'error');
                                    updateStatus('Agentlet Core loaded but PageHighlighter not available', 'warning');
                                }

                                updateHighlightingStats();
                                setButtonLoading('initBtn', false);
                            }).catch(error => {
                                log(`‚ùå Initialization failed: ${error.message}`, 'error');
                                updateStatus('Initialization failed: ' + error.message, 'error');
                                setButtonLoading('initBtn', false);
                            });
                            
                        } catch (error) {
                            log(`‚ùå Error creating AgentletCore instance: ${error.message}`, 'error');
                            updateStatus('Error creating instance: ' + error.message, 'error');
                            setButtonLoading('initBtn', false);
                        }
                    } else {
                        log('‚ùå AgentletCore constructor not available', 'error');
                        updateStatus('AgentletCore constructor not found', 'error');
                        setButtonLoading('initBtn', false);
                    }
                };

                script.onerror = () => {
                    log('‚ùå Failed to load Agentlet Core script', 'error');
                    updateStatus('Failed to load Agentlet Core. Make sure you ran "npm run build" first.', 'error');
                    setButtonLoading('initBtn', false);
                };

                document.head.appendChild(script);

            } catch (error) {
                log(`‚ùå Error: ${error.message}`, 'error');
                updateStatus('Initialization error: ' + error.message, 'error');
                setButtonLoading('initBtn', false);
            }
        }

        function checkStatus() {
            log('üîç Checking Agentlet and PageHighlighter status...');
            
            // More detailed debugging
            log(`üîç window.agentlet exists: ${!!window.agentlet}`);
            if (window.agentlet) {
                log(`üîç window.agentlet.utils exists: ${!!window.agentlet.utils}`);
                if (window.agentlet.utils) {
                    log(`üîç Available utilities: ${Object.keys(window.agentlet.utils).join(', ')}`);
                    log(`üîç PageHighlighter exists: ${!!window.agentlet.utils.PageHighlighter}`);
                }
            }
            
            if (window.agentlet && window.agentlet.utils && window.agentlet.utils.PageHighlighter) {
                log('‚úÖ PageHighlighter is available', 'success');
                try {
                    const stats = window.agentlet.utils.PageHighlighter.getStats();
                    log(`üìä Current highlights: ${stats.highlights}, overlays: ${stats.overlays}`);
                    updateStatus('PageHighlighter is ready for use!', 'success');
                } catch (error) {
                    log(`‚ùå Error calling PageHighlighter.getStats(): ${error.message}`, 'error');
                    updateStatus('PageHighlighter found but has errors', 'error');
                }
            } else if (window.agentlet) {
                log('‚ö†Ô∏è Agentlet loaded but PageHighlighter not found', 'warning');
                updateStatus('Agentlet loaded but PageHighlighter not available', 'warning');
            } else {
                log('‚ùå Agentlet not initialized yet', 'warning');
                updateStatus('Please initialize Agentlet Core first', 'warning');
            }
            
            updateHighlightingStats();
        }

        function ensurePageHighlighter() {
            if (!window.agentlet || !window.agentlet.utils || !window.agentlet.utils.PageHighlighter) {
                updateStatus('Please initialize Agentlet Core first', 'error');
                return null;
            }
            return window.agentlet.utils.PageHighlighter;
        }

        function trackHighlight(type) {
            lastHighlightType = type;
            updateHighlightingStats();
            log(`üéØ ${type} highlight/overlay created`, 'success');
        }

        // Overlay Examples
        function showTopBanner() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('topBannerBtn', true);
            const overlay = ph.showOverlay({
                message: 'üéØ This is a top banner that stays fixed even when you scroll!',
                position: 'top',
                type: 'info',
                duration: 5000
            });
            currentOverlays.push(overlay);
            trackHighlight('Top Banner');
            setTimeout(() => setButtonLoading('topBannerBtn', false), 300);
        }

        function showBottomBanner() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('bottomBannerBtn', true);
            const overlay = ph.showOverlay({
                message: '‚ö†Ô∏è Important notification at the bottom of your screen',
                position: 'bottom',
                type: 'info',
                duration: 5000
            });
            currentOverlays.push(overlay);
            trackHighlight('Bottom Banner');
            setTimeout(() => setButtonLoading('bottomBannerBtn', false), 300);
        }

        function showCenterOverlay() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('centerBtn', true);
            const overlay = ph.showOverlay({
                message: 'This is a centered banner message with blue background.',
                position: 'center',
                type: 'info',
                duration: 8000
            });
            currentOverlays.push(overlay);
            trackHighlight('Centered Banner');
            setTimeout(() => setButtonLoading('centerBtn', false), 300);
        }

        function showWithBackground() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('backgroundBtn', true);
            const overlay = ph.showOverlay({
                message: 'This message has a semi-transparent background overlay',
                position: 'center',
                type: 'info',
                overlay: true,
                duration: 4000
            });
            currentOverlays.push(overlay);
            trackHighlight('Background Overlay');
            setTimeout(() => setButtonLoading('backgroundBtn', false), 300);
        }

        function showCloseableMessage() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('closeableBtn', true);
            const overlay = ph.showOverlay({
                message: 'This message has a close button - click the √ó to close it manually',
                position: 'top',
                type: 'error',
                persistent: true,
                closeable: true
            });
            currentOverlays.push(overlay);
            trackHighlight('Closeable Message');
            setTimeout(() => setButtonLoading('closeableBtn', false), 300);
        }

        function showProgressOverlay() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('progressBtn', true);
            progressOverlay = ph.showOverlay({
                message: 'Processing your request...',
                type: 'progress',
                progress: 0,
                position: 'center',
                overlay: true,
                persistent: true
            });

            // Simulate progress
            let progress = 0;
            const interval = setInterval(() => {
                progress = Math.min(progress + 5, 100);
                progressOverlay.update({ 
                    progress: progress,
                    message: `Processing... ${progress}%`
                });
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        progressOverlay.update({
                            message: 'Complete!',
                            type: 'success'
                        });
                        setTimeout(() => {
                            progressOverlay.hide();
                        }, 2000);
                    }, 500);
                }
            }, 500);

            currentOverlays.push(progressOverlay);
            trackHighlight('Center Progress');
            setTimeout(() => setButtonLoading('progressBtn', false), 300);
        }

        function showTopProgress() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('topProgressBtn', true);
            const topProgressOverlay = ph.showOverlay({
                message: 'Uploading files...',
                type: 'progress',
                progress: 0,
                position: 'top',
                persistent: true,
                closeable: true
            });

            // Simulate progress
            let progress = 0;
            const interval = setInterval(() => {
                progress = Math.min(progress + 8, 100);
                topProgressOverlay.update({ 
                    progress: progress,
                    message: `Uploading files... ${progress}%`
                });
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        topProgressOverlay.update({
                            message: '‚úÖ Upload complete!',
                            type: 'success'
                        });
                        setTimeout(() => {
                            topProgressOverlay.hide();
                        }, 3000);
                    }, 500);
                }
            }, 600);

            currentOverlays.push(topProgressOverlay);
            trackHighlight('Top Progress');
            setTimeout(() => setButtonLoading('topProgressBtn', false), 300);
        }

        function showBottomProgress() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('bottomProgressBtn', true);
            const bottomProgressOverlay = ph.showOverlay({
                message: 'Downloading updates...',
                type: 'progress',
                progress: 0,
                position: 'bottom',
                persistent: true,
                closeable: true
            });

            // Simulate progress
            let progress = 0;
            const interval = setInterval(() => {
                progress = Math.min(progress + 6, 100);
                bottomProgressOverlay.update({ 
                    progress: progress,
                    message: `Downloading updates... ${progress}%`
                });
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        bottomProgressOverlay.update({
                            message: '‚úÖ Download complete! Please restart.',
                            type: 'success'
                        });
                        setTimeout(() => {
                            bottomProgressOverlay.hide();
                        }, 4000);
                    }, 500);
                }
            }, 550);

            currentOverlays.push(bottomProgressOverlay);
            trackHighlight('Bottom Progress');
            setTimeout(() => setButtonLoading('bottomProgressBtn', false), 300);
        }

        function clearAllOverlays() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('clearOverlaysBtn', true);
            log('üßπ Clearing all overlays...', 'info');
            currentOverlays.forEach(overlay => {
                if (overlay && overlay.destroy) {
                    overlay.destroy();
                }
            });
            currentOverlays = [];
            progressOverlay = null;
            updateHighlightingStats();
            setTimeout(() => setButtonLoading('clearOverlaysBtn', false), 300);
        }

        // Highlighting Examples
        function highlightWithBorder() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('borderBtn', true);
            const highlight = ph.highlight('#demo-paragraph', {
                type: 'border',
                style: 'primary',
                message: 'This paragraph is highlighted with a border!',
                animation: 'pulse',
                offset: 5
            });
            
            if (highlight) {
                currentHighlights.push(highlight);
                trackHighlight('Border');
            }
            setTimeout(() => setButtonLoading('borderBtn', false), 300);
        }


        function highlightWithArrow() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('arrowBtn', true);
            const highlight = ph.highlight('#demo-input', {
                type: 'arrow',
                position: 'top',
                message: 'Fill out this input field!',
                style: 'warning'
            });
            
            if (highlight) {
                currentHighlights.push(highlight);
                trackHighlight('Arrow');
            }
            setTimeout(() => setButtonLoading('arrowBtn', false), 300);
        }

        function highlightWithSticker() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('stickerBtn', true);
            const highlight = ph.highlight('#demo-select', {
                type: 'sticker',
                message: '!',
                style: 'danger',
                position: 'top-right'
            });
            
            if (highlight) {
                currentHighlights.push(highlight);
                trackHighlight('Sticker');
            }
            setTimeout(() => setButtonLoading('stickerBtn', false), 300);
        }

        function clearAllHighlights() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('clearHighlightsBtn', true);
            log('üßπ Clearing all highlights...', 'info');
            currentHighlights.forEach(highlight => {
                if (highlight && highlight.destroy) {
                    highlight.destroy();
                }
            });
            currentHighlights = [];
            updateHighlightingStats();
            setTimeout(() => setButtonLoading('clearHighlightsBtn', false), 300);
        }

        // Advanced Features

        function showClickableHighlight() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('clickableBtn', true);
            const highlight = ph.highlight('#demo-table', {
                type: 'border',
                style: 'warning',
                message: 'Click this table!',
                clickable: true,
                onClick: () => {
                    log('üéâ Table was clicked!', 'success');
                    updateStatus('Table clicked! Great job!', 'success');
                    highlight.destroy();
                    currentHighlights = currentHighlights.filter(h => h !== highlight);
                    updateHighlightingStats();
                }
            });
            
            if (highlight) {
                currentHighlights.push(highlight);
                trackHighlight('Clickable');
            }
            setTimeout(() => setButtonLoading('clickableBtn', false), 300);
        }

        function updateHighlightDemo() {
            if (currentHighlights.length === 0) {
                log('‚ö†Ô∏è No highlights to update. Create some highlights first!', 'warning');
                return;
            }

            setButtonLoading('updateBtn', true);
            const highlight = currentHighlights[0];
            if (highlight && highlight.update) {
                highlight.update({
                    message: 'Updated message! ' + new Date().toLocaleTimeString(),
                    style: 'success'
                });
                log('‚úÖ First highlight updated with new message and style', 'success');
                trackHighlight('Updated');
            }
            setTimeout(() => setButtonLoading('updateBtn', false), 300);
        }

        function clearAll() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('clearAllBtn', true);
            log('üßπ Clearing everything...', 'info');
            ph.clearAll();
            currentHighlights = [];
            currentOverlays = [];
            progressOverlay = null;
            updateHighlightingStats();
            setTimeout(() => setButtonLoading('clearAllBtn', false), 300);
        }

        // Scroll Functions
        function scrollToTop() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('scrollTopBtn', true);
            log('‚¨ÜÔ∏è Scrolling to top...', 'info');
            ph.scrollToTop({
                onComplete: () => {
                    log('‚úÖ Scrolled to top successfully', 'success');
                }
            });
            setTimeout(() => setButtonLoading('scrollTopBtn', false), 1000);
        }

        function scrollToBottom() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('scrollBottomBtn', true);
            log('‚¨áÔ∏è Scrolling to bottom...', 'info');
            ph.scrollToBottom({
                onComplete: () => {
                    log('‚úÖ Scrolled to bottom successfully', 'success');
                }
            });
            setTimeout(() => setButtonLoading('scrollBottomBtn', false), 1000);
        }

        function scrollToTable() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('scrollTableBtn', true);
            log('üìä Scrolling to demo table...', 'info');
            ph.scrollTo('#demo-table', {
                block: 'center',
                behavior: 'smooth',
                onComplete: () => {
                    log('‚úÖ Scrolled to table successfully', 'success');
                }
            }).catch(error => {
                log('‚ùå Scroll failed: ' + error.message, 'error');
            });
            setTimeout(() => setButtonLoading('scrollTableBtn', false), 1000);
        }

        function scrollToAndHighlightDemo() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('scrollHighlightBtn', true);
            log('üéØ Scrolling to paragraph and highlighting...', 'info');
            ph.scrollToAndHighlight('#demo-paragraph', {
                block: 'center',
                highlightDuration: 4000,
                onComplete: () => {
                    log('‚úÖ Scrolled and highlighted paragraph', 'success');
                }
            }).then(result => {
                log('üéâ Scroll and highlight completed!', 'success');
                if (result.highlight) {
                    currentHighlights.push(result.highlight);
                    trackHighlight('Scroll + Highlight');
                }
            }).catch(error => {
                log('‚ùå Scroll and highlight failed: ' + error.message, 'error');
            });
            setTimeout(() => setButtonLoading('scrollHighlightBtn', false), 1000);
        }

        function scrollWithOffset() {
            const ph = ensurePageHighlighter();
            if (!ph) return;

            setButtonLoading('scrollOffsetBtn', true);
            log('üìç Scrolling to input with offset...', 'info');
            ph.scrollTo('#demo-input', {
                block: 'start',
                offset: { x: 0, y: -100 }, // 100px above the element
                highlight: true,
                highlightDuration: 3000,
                onComplete: () => {
                    log('‚úÖ Scrolled with offset successfully', 'success');
                }
            }).then(result => {
                log('üéØ Offset scroll completed!', 'success');
                if (result.highlight) {
                    currentHighlights.push(result.highlight);
                    trackHighlight('Offset Scroll');
                }
            }).catch(error => {
                log('‚ùå Offset scroll failed: ' + error.message, 'error');
            });
            setTimeout(() => setButtonLoading('scrollOffsetBtn', false), 1000);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            log('üìÑ PageHighlighter example loaded', 'success');
            updateStatus('Ready for Agentlet initialization', 'info');
            updateHighlightingStats();
        });

        // Update highlighting stats periodically
        setInterval(updateHighlightingStats, 2000);
    </script>
</body>
</html>